<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë””ë²„ê·¸ í˜ì´ì§€</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1e1e1e;
            color: #d4d4d4;
        }
        .check {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .success {
            background: #1e3a1e;
            color: #4caf50;
        }
        .error {
            background: #3a1e1e;
            color: #f44336;
        }
        pre {
            background: #2d2d2d;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>ğŸ› FILLNA ê²Œì„ ë””ë²„ê·¸</h1>
    <div id="checks"></div>
    <pre id="logs"></pre>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <script src="config.js"></script>
    <script>
        const checksDiv = document.getElementById('checks');
        const logsDiv = document.getElementById('logs');
        let logs = [];

        function log(msg, isError = false) {
            const timestamp = new Date().toLocaleTimeString();
            logs.push(`[${timestamp}] ${msg}`);
            logsDiv.textContent = logs.join('\n');
            console.log(msg);
        }

        function check(name, condition, details = '') {
            const div = document.createElement('div');
            div.className = 'check ' + (condition ? 'success' : 'error');
            div.innerHTML = `
                ${condition ? 'âœ…' : 'âŒ'} ${name}
                ${details ? `<br><small>${details}</small>` : ''}
            `;
            checksDiv.appendChild(div);
            log(`${condition ? 'âœ…' : 'âŒ'} ${name} ${details}`);
        }

        async function runChecks() {
            log('=== ë””ë²„ê·¸ ì‹œì‘ ===');

            // 1. Firebase SDK ì²´í¬
            check('Firebase SDK ë¡œë“œ', typeof firebase !== 'undefined');
            
            // 2. Config ì²´í¬
            check('FIREBASE_CONFIG ì¡´ì¬', typeof FIREBASE_CONFIG !== 'undefined');
            
            if (typeof FIREBASE_CONFIG !== 'undefined') {
                check('Firebase apiKey', FIREBASE_CONFIG.apiKey && FIREBASE_CONFIG.apiKey !== 'YOUR_API_KEY', 
                    `apiKey: ${FIREBASE_CONFIG.apiKey.substring(0, 20)}...`);
                check('Firebase databaseURL', FIREBASE_CONFIG.databaseURL && FIREBASE_CONFIG.databaseURL.includes('firebaseio.com'),
                    `URL: ${FIREBASE_CONFIG.databaseURL}`);
            }

            // 3. Firebase ì´ˆê¸°í™”
            try {
                if (typeof firebase !== 'undefined' && !firebase.apps.length) {
                    firebase.initializeApp(FIREBASE_CONFIG);
                    const db = firebase.database();
                    check('Firebase ì´ˆê¸°í™”', true, 'Database ì—°ê²° ì„±ê³µ');
                    
                    // 4. Firebase ì½ê¸° í…ŒìŠ¤íŠ¸
                    try {
                        const snapshot = await db.ref('test').once('value');
                        check('Firebase ì½ê¸° í…ŒìŠ¤íŠ¸', true, `ë°ì´í„°: ${JSON.stringify(snapshot.val())}`);
                    } catch (error) {
                        check('Firebase ì½ê¸° í…ŒìŠ¤íŠ¸', false, error.message);
                    }
                } else {
                    check('Firebase ì´ˆê¸°í™”', false, 'Firebase SDK ì—†ìŒ');
                }
            } catch (error) {
                check('Firebase ì´ˆê¸°í™”', false, error.message);
            }

            // 5. CSV ë¡œë“œ í…ŒìŠ¤íŠ¸
            try {
                log('CSV ë¡œë“œ ì‹œë„...');
                const response = await fetch('data.csv');
                check('CSV fetch', response.ok, `Status: ${response.status}`);
                
                if (response.ok) {
                    const text = await response.text();
                    check('CSV ë‚´ìš©', text.length > 0, `í¬ê¸°: ${text.length} bytes`);
                    
                    const lines = text.trim().split('\n');
                    check('CSV ë ˆì½”ë“œ', lines.length > 1, `${lines.length} ì¤„ (í—¤ë” í¬í•¨)`);
                }
            } catch (error) {
                check('CSV ë¡œë“œ', false, error.message);
            }

            // 6. DOM ìš”ì†Œ ì²´í¬
            check('loginBtn ìš”ì†Œ', document.getElementById('loginBtn') !== null);
            check('studentNo ìš”ì†Œ', document.getElementById('studentNo') !== null);
            check('studentName ìš”ì†Œ', document.getElementById('studentName') !== null);

            log('=== ë””ë²„ê·¸ ì™„ë£Œ ===');
        }

        window.addEventListener('load', runChecks);
    </script>
</body>
</html>

